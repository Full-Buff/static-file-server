<!DOCTYPE html>
<html>
<head>
    <title>FullBuff FastDL</title>
    <link rel="stylesheet" type="text/css" href="/styles.css">
</head>
<body>
    <div class="top-bar">
        <h1><a href="/">FullBuff FastDL</a></h1>
        <% if (uploadAllowed) { %>
            <button id="uploadBtn">Upload</button>
        <% } %>
    </div>
    <div class="container">

        <!-- Breadcrumb Trail -->
        <div class="breadcrumb">
            <% let pathParts = currentPath.split('/').filter(part => part); %>
            <a href="/">Home</a>
            <% let cumulativePath = ''; %>
            <% pathParts.forEach(function(part, index) { %>
                <% cumulativePath += '/' + part; %>
                &gt; <a href="<%= cumulativePath %>"><%= part %></a>
            <% }) %>
        </div>

        <ul>
            <% files.forEach(function(file) { %>
                <li>
                    <a href="<%= encodeURI(file.href) %>" <%= file.isDirectory ? '' : 'download' %>>
                        <%= file.isDirectory ? 'ðŸ“' : 'ðŸ“„' %> <%= file.name %><%= file.isDirectory ? '/' : '' %>
                    </a>
                </li>
            <% }) %>
        </ul>
    </div>

    <!-- Upload Modal -->
    <% if (uploadAllowed) { %>
    <div id="uploadModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <!-- Error Message Display -->
            <div id="errorMessage" class="error-message"></div>
            <form id="uploadForm" enctype="multipart/form-data">
                <input type="hidden" name="path" value="<%= currentPath %>">
                <input type="file" name="file" required><br><br>
                <input type="submit" value="Upload">
            </form>
        </div>
    </div>
    <% } %>

    <script src="/script.js"></script>
</body>
</html>
